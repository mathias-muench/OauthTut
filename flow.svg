<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="583px" preserveAspectRatio="none" style="width:882px;height:583px;background:#FFFFFF;" version="1.1" viewBox="0 0 882 583" width="882px" zoomAndPan="magnify"><defs/><g><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="55" x2="55" y1="36.2969" y2="548.4219"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="343" x2="343" y1="36.2969" y2="548.4219"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="526" x2="526" y1="36.2969" y2="548.4219"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="663" x2="663" y1="36.2969" y2="548.4219"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="845.5" x2="845.5" y1="36.2969" y2="548.4219"/><rect fill="#FFFFFF" height="30.2969" style="stroke:#000000;stroke-width:1.0;" width="71" x="20" y="5"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="57" x="27" y="24.9951">Browser</text><rect fill="#FFFFFF" height="30.2969" style="stroke:#000000;stroke-width:1.0;" width="71" x="20" y="547.4219"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="57" x="27" y="567.417">Browser</text><rect fill="#FFFFFF" height="30.2969" style="stroke:#000000;stroke-width:1.0;" width="53" x="317" y="5"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="39" x="324" y="24.9951">Portal</text><rect fill="#FFFFFF" height="30.2969" style="stroke:#000000;stroke-width:1.0;" width="53" x="317" y="547.4219"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="39" x="324" y="567.417">Portal</text><rect fill="#FFFFFF" height="30.2969" style="stroke:#000000;stroke-width:1.0;" width="153" x="450" y="5"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="139" x="457" y="24.9951">Authorization Server</text><rect fill="#FFFFFF" height="30.2969" style="stroke:#000000;stroke-width:1.0;" width="153" x="450" y="547.4219"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="139" x="457" y="567.417">Authorization Server</text><rect fill="#FFFFFF" height="30.2969" style="stroke:#000000;stroke-width:1.0;" width="60" x="633" y="5"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="46" x="640" y="24.9951">Broker</text><rect fill="#FFFFFF" height="30.2969" style="stroke:#000000;stroke-width:1.0;" width="60" x="633" y="547.4219"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="46" x="640" y="567.417">Broker</text><rect fill="#FFFFFF" height="30.2969" style="stroke:#000000;stroke-width:1.0;" width="61" x="815.5" y="5"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="47" x="822.5" y="24.9951">Device</text><rect fill="#FFFFFF" height="30.2969" style="stroke:#000000;stroke-width:1.0;" width="61" x="815.5" y="547.4219"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="47" x="822.5" y="567.417">Device</text><polygon fill="#000000" points="331.5,63.4297,341.5,67.4297,331.5,71.4297,335.5,67.4297" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="55.5" x2="337.5" y1="67.4297" y2="67.4297"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="70" x="62.5" y="62.3638">Login Page</text><polygon fill="#000000" points="66.5,92.5625,56.5,96.5625,66.5,100.5625,62.5,96.5625" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="60.5" x2="342.5" y1="96.5625" y2="96.5625"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="201" x="72.5" y="91.4966">Redirect to authorization server</text><polygon fill="#000000" points="514.5,121.6953,524.5,125.6953,514.5,129.6953,518.5,125.6953" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="55.5" x2="520.5" y1="125.6953" y2="125.6953"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="258" x="62.5" y="120.6294">Authorization code request to /authorize</text><polygon fill="#000000" points="66.5,150.8281,56.5,154.8281,66.5,158.8281,62.5,154.8281" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="60.5" x2="525.5" y1="154.8281" y2="154.8281"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="216" x="72.5" y="149.7622">Redirect to authentication prompt</text><polygon fill="#000000" points="514.5,179.9609,524.5,183.9609,514.5,187.9609,518.5,183.9609" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="55.5" x2="520.5" y1="183.9609" y2="183.9609"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="176" x="62.5" y="178.895">Authentication and consent</text><polygon fill="#000000" points="66.5,209.0938,56.5,213.0938,66.5,217.0938,62.5,213.0938" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="60.5" x2="525.5" y1="213.0938" y2="213.0938"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="183" x="72.5" y="208.0278">Authorization code response</text><polygon fill="#000000" points="514.5,238.2266,524.5,242.2266,514.5,246.2266,518.5,242.2266" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="55.5" x2="520.5" y1="242.2266" y2="242.2266"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="327" x="62.5" y="237.1606">Send authorization code and client secret to /token</text><polygon fill="#000000" points="66.5,267.3594,56.5,271.3594,66.5,275.3594,62.5,271.3594" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="60.5" x2="525.5" y1="271.3594" y2="271.3594"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="120" x="72.5" y="266.2935">Access token (JWT)</text><polygon fill="#000000" points="331.5,296.4922,341.5,300.4922,331.5,304.4922,335.5,300.4922" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="55.5" x2="337.5" y1="300.4922" y2="300.4922"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="264" x="62.5" y="295.4263">Request with access token (JWT) in cookie</text><line style="stroke:#000000;stroke-width:1.0;" x1="343.5" x2="385.5" y1="329.625" y2="329.625"/><line style="stroke:#000000;stroke-width:1.0;" x1="385.5" x2="385.5" y1="329.625" y2="342.625"/><line style="stroke:#000000;stroke-width:1.0;" x1="344.5" x2="385.5" y1="342.625" y2="342.625"/><polygon fill="#000000" points="354.5,338.625,344.5,342.625,354.5,346.625,350.5,342.625" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="169" x="350.5" y="324.5591">Locally validates JWT token</text><polygon fill="#000000" points="66.5,367.7578,56.5,371.7578,66.5,375.7578,62.5,371.7578" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="60.5" x2="342.5" y1="371.7578" y2="371.7578"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="62" x="72.5" y="366.6919">Response</text><polygon fill="#000000" points="651,396.8906,661,400.8906,651,404.8906,655,400.8906" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="55.5" x2="657" y1="400.8906" y2="400.8906"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="264" x="62.5" y="395.8247">Request with access token (JWT) in cookie</text><line style="stroke:#000000;stroke-width:1.0;" x1="663" x2="705" y1="430.0234" y2="430.0234"/><line style="stroke:#000000;stroke-width:1.0;" x1="705" x2="705" y1="430.0234" y2="443.0234"/><line style="stroke:#000000;stroke-width:1.0;" x1="664" x2="705" y1="443.0234" y2="443.0234"/><polygon fill="#000000" points="674,439.0234,664,443.0234,674,447.0234,670,443.0234" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="169" x="670" y="424.9575">Locally validates JWT token</text><polygon fill="#000000" points="834,468.1563,844,472.1563,834,476.1563,838,472.1563" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="663" x2="840" y1="472.1563" y2="472.1563"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="52" x="670" y="467.0903">Request</text><polygon fill="#000000" points="674,497.2891,664,501.2891,674,505.2891,670,501.2891" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="668" x2="845" y1="501.2891" y2="501.2891"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="62" x="680" y="496.2231">Response</text><polygon fill="#000000" points="66.5,526.4219,56.5,530.4219,66.5,534.4219,62.5,530.4219" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="60.5" x2="662" y1="530.4219" y2="530.4219"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="62" x="72.5" y="525.356">Response</text><!--MD5=[72f6a8939facf7494d40efaf1d30ff4a]
@startuml

!theme plain

Browser -> Portal : Login Page
Browser <- Portal : Redirect to authorization server
Browser -> "Authorization Server" : Authorization code request to /authorize
Browser <- "Authorization Server" : Redirect to authentication prompt
Browser -> "Authorization Server" : Authentication and consent
Browser <- "Authorization Server" : Authorization code response
Browser -> "Authorization Server" : Send authorization code and client secret to /token
Browser <- "Authorization Server" : Access token (JWT)
Browser -> Portal : Request with access token (JWT) in cookie
Portal -> Portal: Locally validates JWT token
Browser <- Portal : Response
Browser -> Broker : Request with access token (JWT) in cookie
Broker -> Broker: Locally validates JWT token
Broker -> Device : Request
Broker <- Device : Response
Browser <- Broker : Response


@enduml

@startuml








<style>
  root {
    BackgroundColor white
    FontColor black
    FontName Verdana
    HyperLinkColor blue
    LineColor black
    LineThickness 1
    Margin 5
  }
  caption {
    LineThickness 0
  }
  footer {
    LineThickness 0
  }
  header {
    LineThickness 0
  }
  node {
    MaximumWidth 300
  }
  title {
    FontSize 22
    LineThickness 0
  }
</style>

skinparam ArrowLollipopColor black
skinparam BackgroundColor white
skinparam DefaultFontName Verdana
skinparam DefaultMonospacedFontName Courier
skinparam LifelineStrategy nosolid
skinparam ParticipantPadding 10
skinparam SequenceLifeLineBorderColor black
skinparam Shadowing false
skinparam UseBetaStyle true

skinparam Activity {
  BackgroundColor white
  BarColor black
  BorderColor black
  FontColor black
  FontName Verdana
}
skinparam Boundary {
  FontColor black
}
skinparam Box {
  Padding 5
}
skinparam CircledCharacter {
  FontColor black
  FontName Courier
  Radius 9
}
skinparam Class {
  BackgroundColor white
  BorderColor black
  FontColor black
  FontName Verdana
}
skinparam ClassAttribute {
  FontColor black
  FontName Verdana
}
skinparam ClassStereotype {
  FontColor black
  FontName Verdana
}
skinparam Footer {
  FontColor black
  FontName Verdana
}
skinparam Header {
  FontColor black
  FontName Verdana
}
skinparam Hyperlink {
  Color blue
}
skinparam IconPackage {
  Color black
  BackgroundColor white
}
skinparam IconPrivate {
  Color black
  BackgroundColor white
}
skinparam IconProtected {
  Color black
  BackgroundColor white
}
skinparam IconPublic {
  Color black
  BackgroundColor white
}
skinparam Note {
  FontColor black
  FontName Verdana
}
skinparam Package {
  BorderColor black
  FontColor black
  FontName Verdana
}
skinparam State {
  BackgroundColor white
  BorderColor black
}
skinparam StereotypeA {
  BackgroundColor white
  BorderColor black
}
skinparam StereotypeC {
  BackgroundColor white
  BorderColor black
}
skinparam StereotypeE {
  BackgroundColor white
  BorderColor black
}
skinparam StereotypeI {
  BackgroundColor white
  BorderColor black
}
skinparam StereotypeN {
  BackgroundColor white
  BorderColor black
}
skinparam UseCaseStereoType {
  FontColor black
  FontName Verdana
}

Browser -> Portal : Login Page
Browser <- Portal : Redirect to authorization server
Browser -> "Authorization Server" : Authorization code request to /authorize
Browser <- "Authorization Server" : Redirect to authentication prompt
Browser -> "Authorization Server" : Authentication and consent
Browser <- "Authorization Server" : Authorization code response
Browser -> "Authorization Server" : Send authorization code and client secret to /token
Browser <- "Authorization Server" : Access token (JWT)
Browser -> Portal : Request with access token (JWT) in cookie
Portal -> Portal: Locally validates JWT token
Browser <- Portal : Response
Browser -> Broker : Request with access token (JWT) in cookie
Broker -> Broker: Locally validates JWT token
Broker -> Device : Request
Broker <- Device : Response
Browser <- Broker : Response


@enduml

PlantUML version 1.2021.9(Sun Jul 25 12:13:56 CEST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>